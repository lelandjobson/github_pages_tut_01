<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>{{ page.title }}</title>
  {% if page.description %}
  <meta name="description" content="{{ page.description }}">{% endif %}
  <meta name="author" content="{{ site.author.name }}">

  <!-- Enable responsive viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

  <!-- Le styles -->
  <link href="{{ ASSET_PATH }}/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="{{ ASSET_PATH }}/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
  <link href="{{ ASSET_PATH }}/css/fonts.css" rel="stylesheet" type="text/css" media="all">
  <link href="{{ BASE_PATH }}/assets/themes/scripts/vakata-tree/themes/default/style.css" rel="stylesheet" />

  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
    crossorigin="anonymous">

  <!-- atom & rss feed -->
  <!-- <link href="{{ BASE_PATH }}{{ site.JB.atom_path }}" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="{{ BASE_PATH }}{{ site.JB.rss_path }}" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">   -->

  <!-- jquery is used in the nav and the bg change  -->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>

  <!-- jsTree TreeView side navigation script -->
  <script src="{{ BASE_PATH }}/assets/themes/scripts/vakata-tree/jstree.js"></script>

  <!-- Run the script to transform the sidenav into a treeview -->
  <script>
    $(function () { 
        // $('#jsTreeNav').jstree();        
        $('#jsTreeNav')
          // listen for event
          .on('select_node.jstree', function (e, data) {
            console.log("Tree item selected", data.node.a_attr.href);
            window.location.href = data.node.a_attr.href;
          })
          .on('click', '.jstree-anchor', function (e) {
            $('#jsTreeNav').jstree(true).toggle_node(e.target);
          })
          // create the instance
          .jstree({
            // core : {
            //   dblclick_toggle : false
            // }
          });
      });
    </script>

</head>

<body class="wrapper">
  <!-- TOP NAVIGATION -->
  <nav class="navbar navbar-expand-lg fixed-top navbar-dark bg-dark">
    <div class="container">
      <img class=" navbar-brand "src="/assets/images/global/itl_white_clear.png" style="margin: 0; margin-right: 40px">
      <a class="navbar-brand" href="{{ HOME_PATH }}">{{ site.title }}</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarText">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item">
            <a class="nav-link" href="{{ HOME_PATH }}#ourProject">About</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Contribute</a>
          </li>
        </ul>
        <span class="navbar-text">
          v.0.1.2
        </span>
      </div>
    </div>
  </nav>
  <div class="container-fluid">
    <div class="row">
      <!-- SIDE NAVIGATION -->
      <div class="col-2">
        <div id="jsTreeNav" class="sidenav">
          <ul>
            {% assign myCats = site.pages | group_by: 'category' %}
              {% for cat in myCats %}
                <!-- Create the category header -->
                {% if cat.name != "" %}
                <li data-jstree='{"opened":true, "icon":"fa fa-cubes"}'>{{ cat.name}}
                <ul>
                {% assign subCats = cat.items | group_by: 'subcategory' %}
                {% for subcat in subCats %}   
                {% if subcat.name != "None" %}
                  {% assign items = subcat.items | sort: 'order' %}
                  {% if page.field-guide == subcat.name %}
                    <li data-jstree='{"opened":true, "icon":"fa fa-book"}' class="nav-header currentguide">{{ subcat.name }}
                  {% else %}
                    <li data-jstree='{"icon":"fa fa-book"}' class="nav-header currentguide">{{ subcat.name }}
                  {% endif %}
                  <ul>
                    {% for item in items %}
                      {% capture nowunix %}{{'now' | date: '%s'}}{% endcapture %}
                      <!-- TODO: If the post is younger than 10 days, thrown in a NEW tag -->
                      {% if item.url == page.url %}
                      <li data-jstree='{"selected":true, "icon":"{{ BASE_PATH }}{{ item.dir }}/{{ item.title | downcase }}.png"}'
                        class="nav-item current newItem"><a>{{ item.title }}</a></li>
                      {% else %}
                      <li data-jstree='{"icon":"{{ BASE_PATH }}{{ item.dir }}/{{ item.title | downcase }}.png"}' class="nav-item"><a
                          href="{{ BASE_PATH}}{{ item.url }}">{{ item.title }}</a></li>
                      {% endif %}
                    {% endfor %}
                  </ul>
                {% endif %}
              </li>
              {% endfor %}
            </ul>
            </li>
            {% endif %}
            {% endfor %}
          </ul>
        </div>
      </div>
      <!-- CONTENT (post.html, home.html, etc.) -->
      <div class="col-10">
        {{ content }}
      </div>
    </div>
  </div>
  {% include JB/analytics %}
</body>

</html>